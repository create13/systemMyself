webpackJsonp([5],{"42lZ":function(e,t){},VQIa:function(e,t){},Z1SP:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("mvHQ"),r=o.n(a),s=o("woOf"),i=o.n(s),n=o("BO1k"),l=o.n(n),c={name:"baseAcount",data:function(){var e=this;return{value1:"",swtichState:!0,receptInfo:null,stateChange:null,editChange:null,popShow:!1,editShow:!1,resetShow:!1,stateNames:"启用",treeParams:-1,editRoles:[],getMenuId:null,getDatas:this.$store.getters.getTabs,paramsDatas:{myColor:"",loadingSearch:!1},popTitle:"",roleName:"",classRole:"percent-forms",roleData:[{formType:"input",lables:"角色名称",props:"roleMemo",modelData:"",types:"text"},{formType:"input",lables:"角色描述",props:"roleDesc",modelData:"",types:"text"},{formType:"switch",lables:"角色状态",props:"roleStatus",modelData:!0}],inputRole:[{lables:"角色查询",models:"",spans:4,types:"input"},{lables:"查询",spans:5,types:"button"}],formValidate:{loginName:"",pass:"",userStatus:"",userName:""},resetPass:{password:"",newPass:"",surePass:""},editform:{},ruleValidate:{roleMemo:[{required:!0,message:"请输入账户名称",trigger:"blur"}]},columnsTable:[{type:"index",width:60,align:"center"},{title:"操作",key:"opration",align:"center",width:123,render:function(t,o){return t("div",[t("a",{props:{size:"small"},style:{marginRight:"6px",color:"#108CEE",textDecoration:"underline"},on:{click:function(){e.show(o.index)}}},"冻结"),t("a",{props:{size:"small"},style:{marginRight:"-5px",color:"#108CEE",textDecoration:"underline"},on:{click:function(){e.show(o.index)}}},"查看明细")])}},{title:"角色名称",key:"roleMemo"},{title:"角色描述",key:"roleDesc"},{title:"角色状态",key:"roleStatus"},{title:"创建时间",key:"createTime"}],treeRoles:[],tableRole:[],pages:1,sizes:10}},components:{},computed:{},watch:{},mounted:function(){this.getRole(),this.getTreeData(),console.log(this.editform),console.log(this.treeRoles)},methods:{searchRole:function(){var e=!0,t=!1,o=void 0;try{for(var a,r=l()(this.inputRole);!(e=(a=r.next()).done);e=!0){var s=a.value;"input"===s.types&&"角色查询"===s.lables&&(this.roleName=s.models)}}catch(e){t=!0,o=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw o}}this.getRole({roleMemo:this.roleName})},blurRole:function(e){var t=!0,o=!1,a=void 0;try{for(var r,s=l()(this.roleData);!(t=(r=s.next()).done);t=!0){var i=r.value;this.formValidate[i.props]=e}}catch(e){o=!0,a=e}finally{try{!t&&s.return&&s.return()}finally{if(o)throw a}}},changeStatus:function(e){!0===e?(this.stateNames="启用",this.formValidate.status=!0):(this.stateNames="不启用",this.formValidate.status=!1)},nowStatus:function(){},stateStatus:function(){},editData:function(e,t){console.log(e),"启用"===e.roleStatus?e.roleStatus=!0:e.roleStatus=!1,this.editform=i()({},e),this.refreshPower()},colorChange:function(e){this.paramsDatas.myColor=e},resetColor:function(){this.paramsDatas.myColor=""},toLoadings:function(){this.$refs.table.exportCsv({filename:"表格数据"})},pageChange:function(e){this.pages=e,this.getRole()},newCreate:function(e,t){if(this.popTitle=t,"角色管理新建角色"===t){var o=!0,a=!1,s=void 0;try{for(var i,n=l()(this.roleData);!(o=(i=n.next()).done);o=!0){var c=i.value;"switch"===c.formType?c.modelData=!0:c.modelData=""}}catch(e){a=!0,s=e}finally{try{!o&&n.return&&n.return()}finally{if(a)throw s}}this.formSave=JSON.parse(r()(this.roleData)),this.popShow=!this.popShow}else if("角色管理修改角色"===t)if(this.editRoles=this.roleData,this.editform.createCid){console.log(this.editform.createCid);var h=!0,d=!1,u=void 0;try{for(var f,m=l()(this.editRoles);!(h=(f=m.next()).done);h=!0){var p=f.value;p.modelData=this.editform[p.props]}}catch(e){d=!0,u=e}finally{try{!h&&m.return&&m.return()}finally{if(d)throw u}}console.log(this.editform),this.editShow=!this.editShow}else this.$Message.error("请选中要修改的行");else"角色管理删除角色"===t&&(this.editform.createCid?(this.delInfo(),this.editform.createCid=null):this.$Message.error("请选中要修改的行"))},roleSubmit:function(e){var t=this,o=!0,a=!1,r=void 0;try{for(var s,i=l()(this.roleData);!(o=(s=i.next()).done);o=!0){var n=s.value;this.formValidate[n.props]=n.modelData}}catch(e){a=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(a)throw r}}this.$refs[e].validate(function(o){if(o){!0===t.formValidate.roleStatus?t.stateChange=1:t.stateChange=0;var a={createCid:t.$store.getters.getInfo.companyId,createUid:t.$store.getters.getInfo.userId,roleMemo:t.formValidate.roleMemo,roleDesc:t.formValidate.roleDesc,roleStatus:t.stateChange};t.$service.http.post("winpie/admin/role/addUpdateRole",a,"post").then(function(o){t.$Message.success("新增成功"),t.$refs[e].resetFields(),t.roleData=[],t.roleData=t.formSave,t.getRole(),t.popShow=!1}).catch(function(e){console.log(e),t.$Message.error(e.msg)})}else t.$Message.error("Fail!")})},editSubmit:function(e){var t=this,o=!0,a=!1,r=void 0;try{for(var s,i=l()(this.editRoles);!(o=(s=i.next()).done);o=!0){var n=s.value;this.editform[n.props]=n.modelData}}catch(e){a=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(a)throw r}}!0===this.editform.roleStatus?this.editChange=1:this.editChange=0;var c={roleMemo:this.editform.roleMemo,roleDesc:this.editform.roleDesc,roleStatus:this.editChange,roleId:this.editform.roleId};this.$service.http.post("winpie/admin/role/addUpdateRole",c,"post").then(function(e){t.$Message.success("修改成功"),t.getRole(),t.editform.createCid=null,t.editShow=!1}).catch(function(e){console.log(e),t.$Message.error(e.msg)})},handleReset:function(e){this.$refs[e].resetFields(),this.popShow=!1},editReset:function(){this.editShow=!1},getRole:function(e){var t=this,o={page:this.pages,rows:this.sizes,filters:r()(e||{companyId:this.$store.getters.getInfo.companyId})};this.$service.http.post("winpie/admin/role/list",o,"post").then(function(e){t.tableRole=null,t.tableRole=e.result.rows;var o=!0,a=!1,r=void 0;try{for(var s,i=l()(t.tableRole);!(o=(s=i.next()).done);o=!0){var n=s.value;1===n.roleStatus?n.roleStatus="启用":n.roleStatus="不启用"}}catch(e){a=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(a)throw r}}}).catch(function(e){console.log(e)})},delInfo:function(){var e=this,t={roleId:this.editform.roleId};this.$service.http.post("winpie/admin/role/deleteRole",t,"post").then(function(t){console.log(t),e.$Message.success("删除成功"),e.getRole()}).catch(function(t){console.log(t),e.$Message.error(t.msg)})},getTreeData:function(){var e=this,t={parentId:this.treeParams};this.$service.http.post("winpie/admin/menu/loadCheckMenuInfo",t,"post").then(function(t){e.treeRoles=JSON.parse(t.result),e.recursionRole(e.treeRoles)}).catch(function(t){console.log(t),e.$Message.error(t.msg)})},recursionRole:function(e){var t=[],o=!0,a=!1,r=void 0;try{for(var s,i=l()(e);!(o=(s=i.next()).done);o=!0){var n=s.value,c=n.name,h=n.nodes,d=n.menuId;if(h)h=this.recursionRole(h);t.push({title:c,expand:!0,children:h,onlyId:d})}}catch(e){a=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(a)throw r}}return this.treeRoles=t,this.treeRoles},refreshPower:function(){var e=this;if(this.editform.roleId){var t={roleId:this.editform.roleId};this.$service.http.post("winpie/admin/role/authorityRoleAccess",t,"post").then(function(t){e.getMenuId=t.result,e.compareTree(e.treeRoles,e.getMenuId)}).catch(function(t){console.log(t),e.$Message.error(t.msg)})}},compareTree:function(e,t){var o=!0,a=!1,r=void 0;try{for(var s,i=l()(e);!(o=(s=i.next()).done);o=!0){var n=s.value;if(n.children){var c=this.compareTree(n.children,t);n.children=c}}}catch(e){a=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(a)throw r}}return this.treeRoles=[],this.treeRoles},saveImpover:function(){}}},h={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"manage-set"},[o("div",{staticClass:"center-content"},[o("div",{staticClass:"input-search"},[o("con-inputs",{attrs:{setInput:e.inputRole,paramsData:e.paramsDatas},on:{changeColor:e.colorChange,resetColor:e.resetColor,searchTable:e.searchRole}})],1),e._v(" "),o("Row",[o("i-col",{attrs:{span:"19"}},[o("div",{staticClass:"input-search row-set"},[o("Row",{attrs:{gutter:20}},[o("i-col",{attrs:{span:"24"}},[o("Button",{attrs:{type:"primary",icon:"android-exit"},on:{click:e.toLoadings}},[o("span",[e._v("导出")])]),e._v(" "),e._l(e.getDatas,function(t,a){return o("Button",{key:a,on:{click:function(o){e.newCreate(t.menuId,t.name)}}},[e._v(e._s(t.name))])})],2)],1)],1),e._v(" "),o("div",{staticClass:"table-show"},[o("Table",{ref:"table",attrs:{columns:e.columnsTable,data:e.tableRole,"highlight-row":"",border:""},on:{"on-current-change":e.editData}}),e._v(" "),o("Page",{attrs:{total:100,"show-elevator":""},on:{"on-change":e.pageChange}})],1)]),e._v(" "),o("i-col",{attrs:{span:"5"}},[o("div",{staticClass:"fonts-explain"},[o("span",[e._v("权限树")]),e._v(" "),o("span",{staticClass:"specials"},[e._v("平台系统管理员")]),e._v(" "),o("Button",{attrs:{type:"primary",icon:"document-text"},on:{click:e.saveImpover}},[e._v("保存授权")])],1),e._v(" "),o("div",{staticClass:"tree-construction"},[o("Tree",{attrs:{data:e.treeRoles,"show-checkbox":"",multiple:""}})],1)])],1)],1)]),e._v(" "),o("Modal",{attrs:{title:e.popTitle,"class-name":"vertical-center-modal setModal",draggable:""},on:{"on-visible-change":e.nowStatus},model:{value:e.popShow,callback:function(t){e.popShow=t},expression:"popShow"}},[o("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":80}},[o("con-checkform",{attrs:{formList:e.roleData,setClass:e.classRole,stateName:e.stateNames},on:{blurEvent:e.blurRole,changeStatus:e.changeStatus}}),e._v(" "),o("FormItem",[o("Button",{attrs:{type:"primary"},on:{click:function(t){e.roleSubmit("formValidate")}}},[e._v("确定")]),e._v(" "),o("Button",{staticStyle:{"margin-left":"40px"},on:{click:function(t){e.handleReset("formValidate")}}},[e._v("取消")])],1)],1)],1),e._v(" "),o("Modal",{attrs:{title:e.popTitle,draggable:"","class-name":"vertical-center-modal"},model:{value:e.editShow,callback:function(t){e.editShow=t},expression:"editShow"}},[o("Form",{ref:"editform",attrs:{model:e.editform,"label-width":80}},[o("con-checkform",{attrs:{formList:e.editRoles,stateName:e.stateNames,setClass:e.classRole},on:{changeStatus:e.changeStatus}}),e._v(" "),o("FormItem",[o("Button",{attrs:{type:"primary"},on:{click:function(t){e.editSubmit("editform")}}},[e._v("确定")]),e._v(" "),o("Button",{staticStyle:{"margin-left":"4px"},on:{click:function(t){e.editReset("editform")}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var d=o("VU/8")(c,h,!1,function(e){o("VQIa"),o("42lZ")},"data-v-e7963d5e",null);t.default=d.exports}});
//# sourceMappingURL=5.20a2a49681a203523400.js.map